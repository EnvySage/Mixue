import{_ as b,r as _,c as d,F as y,e as A,d as e,g as m,h as j,m as S,t as u,n as w,i as B,b as r,l as K,o as V,p as I,f as C,w as E,q as T,s as h,k as P,x as W,y as G}from"./index-BVNTGA3w.js";import{M as H}from"./MainNav-BpoAeEj3.js";import{u as M}from"./products-Bx2MbbLe.js";import{u as N}from"./shopCar-A9r8-SBz.js";import{u as J}from"./order-GJ75ViXz.js";import{u as z}from"./snack-C75NDPgZ.js";const R={class:"bread-title-container"},X={__name:"breadTitle",setup(g){const n=[{name:"经典菜单",url:"classicmenu"},{name:"0元兑零食",url:"zeroExchange"},{name:"双杯9.9起",url:"double99"},{name:"我的常点",url:"commonOrder"}],l=_(0),i=s=>{l.value=s};return(s,o)=>{const v=B("router-link");return r(),d("div",R,[(r(),d(y,null,A(n,(k,p)=>e("div",{key:p},[m(v,{to:k.url,class:w(["bread-title",{active:p===l.value}]),onClick:f=>i(p)},{default:j(()=>[S(u(k.name),1)]),_:2},1032,["to","class","onClick"])])),64))])}}},Y=b(X,[["__scopeId","data-v-cdabb1f4"]]),Z={class:"top-bar"},ee={class:"TabCard"},te={__name:"topBar",setup(g){const n=_(0),l=i=>{n.value=i};return(i,s)=>(r(),d("div",Z,[e("div",ee,[e("div",{class:w(["TabCard-item",{active:n.value===0}]),onClick:s[0]||(s[0]=o=>l(0))}," 自提 ",2),e("div",{class:w(["TabCard-item",{active:n.value===1}]),onClick:s[1]||(s[1]=o=>l(1))}," 外送 ",2)]),s[2]||(s[2]=e("div",{class:"search"},[e("div",{class:"iconfont icon-sousuo"}),e("input",{type:"text",placeholder:"搜索商品"})],-1))]))}},se=b(te,[["__scopeId","data-v-d0881eab"]]),ae={},oe={class:"destination-card"};function ce(g,n){return r(),d("div",oe,n[0]||(n[0]=[K('<div class="store-info" data-v-3bdc69f5><div class="star-icon icon-shoucang iconfont" data-v-3bdc69f5></div><span class="store-name" data-v-3bdc69f5>蜜雪冰城（印象汇店）</span><span class="arrow" data-v-3bdc69f5>&gt;</span></div><div class="distance-info" data-v-3bdc69f5><div class="location-icon icon-weizhi iconfont" data-v-3bdc69f5></div><span class="distance-text" data-v-3bdc69f5>直线距离954m</span></div><div class="coupon-info-container" data-v-3bdc69f5><div class="coupon-info" data-v-3bdc69f5><div class="coupon-icon icon-laba iconfont" data-v-3bdc69f5></div><span class="coupon-text" data-v-3bdc69f5>进群领30元券包！</span></div><div class="view-more" data-v-3bdc69f5>查看更多 &gt;</div></div>',3)]))}const ne=b(ae,[["render",ce],["__scopeId","data-v-3bdc69f5"]]),le="/assets/%E8%9C%9C%E9%9B%AA%E5%86%B0%E5%9F%8E-zbWykuKs.png",re={class:"cont-header"},de={class:"select-all"},ie={class:"productList",style:{"max-height":"280px","overflow-y":"auto","overflow-x":"hidden"}},ue=["onUpdate:modelValue"],ve=["src"],pe={class:"product-info",style:{width:"45%"}},_e={class:"product-name"},fe={class:"product-desc",style:{"font-size":"10px",width:"70%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},he={key:0,style:{"margin-top":"5px"}},me={key:1,style:{"margin-top":"2px"}},ke={key:2,style:{"margin-top":"2px"}},Ce={class:"product-price"},be={class:"price"},ge={class:"nums"},ye=["onClick"],xe={class:"num"},we=["onClick"],Se={class:"shop-car"},$e={class:"quantity"},Ie={class:"cal"},Ee={class:"total"},Te={__name:"ShopCarComponent",setup(g){const n=J(),l=N(),i=M(),s=z(),o=_([]),v=_(!1),k=()=>{v.value=!1},p=()=>{v.value=!0,o.value=l.getCartItems(),console.log(o.value)},f=_(!0);V(async()=>{await i.getAll(),await s.getAll(),o.value=l.getCartItems(),$()});const $=()=>{o.value.forEach(a=>{a.selected=f.value}),f.value=o.value.every(a=>a.selected)},L=()=>{f.value=o.value.every(a=>a.selected)},O=I(()=>o.value.reduce((a,c)=>c.selected?a+c.num:a,0)),U=I(()=>o.value.reduce((a,c)=>c.selected?a+(c.price||0)*c.num:a,0)),F=()=>{if(o.value.length===0){s.showSnack("购物车为空，请选择商品");return}alert("结算成功"),n.createOrder(o.value.filter(a=>a.selected)),l.clearCart(),o.value=[]},q=()=>{l.clearCart(),o.value=[]},D=a=>{a.num>1?a.num--:l.removeCartItem(a.id,a.type)},Q=a=>{a.num++};return(a,c)=>(r(),d(y,null,[v.value?(r(),d("div",{key:0,class:"mask",onClick:k},[e("div",{class:"cont",onClick:c[1]||(c[1]=P(()=>{},["stop"]))},[e("div",re,[e("div",de,[E(e("input",{type:"checkbox","onUpdate:modelValue":c[0]||(c[0]=t=>f.value=t),onChange:$},null,544),[[T,f.value]]),c[2]||(c[2]=e("span",null,"全选",-1))]),e("div",{class:"clear"},[c[3]||(c[3]=e("div",{class:"iconfont"},null,-1)),e("span",{onClick:q},"清空购物车")])]),e("div",ie,[(r(!0),d(y,null,A(o.value,t=>(r(),d("div",{class:"product",key:t.id},[E(e("input",{type:"checkbox","onUpdate:modelValue":x=>t.selected=x,onChange:L},null,40,ue),[[T,t.selected]]),e("img",{src:t.type==="product"?h(i).products[t.id-1].imageUrl:h(s).snacks[t.id-101].imageUrl,style:{width:"70px",height:"70px","border-radius":"50%"}},null,8,ve),e("div",pe,[e("div",_e,u(t.type==="product"?h(i).products[t.id-1].name:h(s).snacks[t.id-101].name),1),e("div",fe,[S(u(t.type==="product"?h(i).products[t.id-1].description:h(s).snacks[t.id-101].description)+" ",1),t.selectedTemperature?(r(),d("div",he,"温度: "+u(t.selectedTemperature),1)):C("",!0),t.selectedSugar?(r(),d("div",me,"糖度: "+u(t.selectedSugar),1)):C("",!0),t.selectedExtras&&t.selectedExtras.length>0?(r(),d("div",ke," 加料: "+u(t.selectedExtras.join(",")),1)):C("",!0)]),e("div",Ce,"¥"+u(t.price),1)]),e("div",be,[e("div",ge,[e("button",{onClick:x=>D(t),style:{"background-color":"transparent"}},"-",8,ye),e("span",xe,u(t.num),1),e("button",{onClick:x=>Q(t),style:{"background-color":"#f40",color:"white"}},"+",8,we)])])]))),128))])])])):C("",!0),e("div",Se,[e("div",{class:"logo",onClick:p},[c[4]||(c[4]=e("img",{src:le,alt:""},null,-1)),e("div",$e,u(O.value),1)]),e("div",Ie,[e("div",Ee,"合计:￥"+u(U.value),1),e("button",{onClick:F},"结算")])])],64))}},Ae=b(Te,[["__scopeId","data-v-3b7e5dd8"]]),Be={class:"scroll-container"},Ve={class:"header"},Me={class:"scroll"},Ne={__name:"OrderViewLayout",setup(g){const n=N(),l=M(),i=z(),s=_(!1),o=_([]);return V(async()=>{await l.getAll(),await i.getAll(),o.value=n.getCartItems(),o.value.length>0&&(s.value=!0)}),W(()=>n.getCartItems(),v=>{o.value=v,v.length>0&&s.value===!1?s.value=!0:v.length===0&&s.value===!0&&(s.value=!1)},{deep:!0}),(v,k)=>{const p=B("router-view");return r(),d(y,null,[e("div",Be,[e("div",Ve,[S(u()+" ",1),m(se,{class:"top-bar"}),m(ne,{class:"destination-card"}),m(Y,{class:"bread-title-container"})]),e("div",Me,[m(p,{class:"order-view"})])]),s.value?(r(),G(Ae,{key:0})):C("",!0),m(H)],64)}}},De=b(Ne,[["__scopeId","data-v-17ccbd1e"]]);export{De as default};
