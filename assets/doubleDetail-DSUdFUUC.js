import{_ as k,r,z as h,o as C,c as d,d as t,t as n,n as I,b as v}from"./index-BVNTGA3w.js";import{u as S}from"./products-Bx2MbbLe.js";import{u as B}from"./shopCar-A9r8-SBz.js";import{u as w}from"./order-GJ75ViXz.js";const q={key:0,class:"details-page"},x={class:"product-image"},F=["src"],D={class:"product-header"},P={class:"product-details"},U={class:"detail-content"},$={class:"bottom-bar"},z={class:"price-info"},N={class:"current-price"},O={class:"original-price"},E={class:"quantity-selector"},M={class:"quantity"},R={key:1},T={__name:"doubleDetail",setup(V){const l=S(),p=B(),_=h(),c=r(!1),a=r(1),i=r(!0),m=_.params.id,s=r(null);C(async()=>{try{await l.getById(m),s.value=l.product,console.log(s.value),s.value||console.error("未能获取到双重奶数据")}catch(e){console.error("获取双重奶详情时出错",e)}finally{i.value=!1}});const y=()=>{c.value=!c.value},b=async()=>{if(s.value){const e=await l.getById(s.value.productId),o={...e,id:e.productId,type:"product",num:a.value,price:e.price*a.value};p.addToCart(o)}alert("加入购物车成功"),history.back()},f=async()=>{if(s.value){const e=await l.getById(s.value.productId),o={id:e.productId,name:e.name,imgUrl:e.imageUrl,type:"product",num:a.value,price:e.price*a.value};await w().createOrder([o]),history.back()}},g=()=>{history.back()};return(e,o)=>i.value?(v(),d("div",R,"加载中...")):(v(),d("div",q,[t("div",{class:"back-button",onClick:g},o[2]||(o[2]=[t("div",{class:"iconfont icon-fanhui"},null,-1)])),t("div",x,[t("img",{src:`${s.value.imageUrl}`,alt:"产品图片"},null,8,F)]),t("div",D,[t("h2",null,n(s.value.name),1),t("div",{class:"favorite",onClick:y},[t("span",{class:I(["star-icon",{filled:c.value}])},"★",2),o[3]||(o[3]=t("span",null,"收藏口味",-1))])]),t("div",P,[o[4]||(o[4]=t("h3",null,"商品详情",-1)),t("div",U,n(s.value.description),1)]),t("div",$,[t("div",z,[t("span",N,"¥"+n((s.value.price*a.value).toFixed(1)),1),t("span",O,"¥"+n((s.value.price*1.2).toFixed(1)),1)]),t("div",E,[t("button",{class:"quantity-btn",onClick:o[0]||(o[0]=u=>a.value>1&&a.value--)},"-"),t("span",M,n(a.value),1),t("button",{class:"quantity-btn",onClick:o[1]||(o[1]=u=>a.value++)},"+")]),t("div",{class:"action-buttons"},[t("button",{class:"buy-now-btn",onClick:f},"立即购买"),t("button",{class:"add-cart-btn",onClick:b},"加入购物车")])])]))}},J=k(T,[["__scopeId","data-v-416d4a3e"]]);export{J as default};
