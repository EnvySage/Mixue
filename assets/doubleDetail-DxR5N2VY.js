import{_ as h,g as k,p as C,r as c,q as I,h as S,c as u,a as t,t as n,n as B,m as q,o as v}from"./index-C3Xy8R7w.js";const w={key:0,class:"details-page"},x={class:"product-image"},F=["src"],D={class:"product-header"},P={class:"product-details"},U={class:"detail-content"},$={class:"bottom-bar"},N={class:"price-info"},O={class:"current-price"},z={class:"original-price"},E={class:"quantity-selector"},M={class:"quantity"},R={key:1},T={__name:"doubleDetail",setup(V){const l=k(),p=C(),_=I(),i=c(!1),a=c(1),r=c(!0),y=_.params.id,s=c(null);S(async()=>{try{await l.getById(y),s.value=l.product,console.log(s.value),s.value||console.error("未能获取到双重奶数据")}catch(e){console.error("获取双重奶详情时出错",e)}finally{r.value=!1}});const b=()=>{i.value=!i.value},m=async()=>{if(s.value){const e=await l.getById(s.value.productId),o={...e,id:e.productId,type:"product",num:a.value,price:e.price*a.value};p.addToCart(o)}alert("加入购物车成功"),history.back()},f=async()=>{if(s.value){const e=await l.getById(s.value.productId),o={id:e.productId,name:e.name,imgUrl:e.imageUrl,type:"product",num:a.value,price:e.price*a.value};await q().createOrder([o]),history.back()}},g=()=>{history.back()};return(e,o)=>r.value?(v(),u("div",R,"加载中...")):(v(),u("div",w,[t("div",{class:"back-button",onClick:g},o[2]||(o[2]=[t("div",{class:"iconfont icon-fanhui"},null,-1)])),t("div",x,[t("img",{src:`${s.value.imageUrl}`,alt:"产品图片"},null,8,F)]),t("div",D,[t("h2",null,n(s.value.name),1),t("div",{class:"favorite",onClick:b},[t("span",{class:B(["star-icon",{filled:i.value}])},"★",2),o[3]||(o[3]=t("span",null,"收藏口味",-1))])]),t("div",P,[o[4]||(o[4]=t("h3",null,"商品详情",-1)),t("div",U,n(s.value.description),1)]),t("div",$,[t("div",N,[t("span",O,"¥"+n((s.value.price*a.value).toFixed(1)),1),t("span",z,"¥"+n((s.value.price*1.2).toFixed(1)),1)]),t("div",E,[t("button",{class:"quantity-btn",onClick:o[0]||(o[0]=d=>a.value>1&&a.value--)},"-"),t("span",M,n(a.value),1),t("button",{class:"quantity-btn",onClick:o[1]||(o[1]=d=>a.value++)},"+")]),t("div",{class:"action-buttons"},[t("button",{class:"buy-now-btn",onClick:f},"立即购买"),t("button",{class:"add-cart-btn",onClick:m},"加入购物车")])])]))}},A=h(T,[["__scopeId","data-v-6d679d07"]]);export{A as default};
