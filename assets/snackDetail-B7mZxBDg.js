import{_ as g,j as h,p as S,r as l,q as C,h as I,c as d,a as t,t as n,n as B,m as q,o as v}from"./index-Br6F0raF.js";const w={key:0,class:"details-page"},U={class:"product-image"},x=["src"],D={class:"product-header"},F={class:"product-details"},$={class:"detail-content"},N={class:"bottom-bar"},O={class:"price-info"},j={class:"current-price"},z={class:"original-price"},E={class:"quantity-selector"},M={class:"quantity"},R={key:1},T={__name:"snackDetail",setup(V){const c=h(),p=S(),_=C(),i=l(!1),o=l(1),r=l(!0),k=_.params.id,a=l(null);I(async()=>{try{await c.getById(k),a.value=c.snack,console.log(a.value),a.value||console.error("未能获取到小吃数据")}catch(e){console.error("获取小吃详情时出错",e)}finally{r.value=!1}});const m=()=>{i.value=!i.value},y=async()=>{if(a.value){const e=await c.getById(a.value.productId),s={...e,id:e.productId,imgUrl:e.imageUrl,type:"snack",num:o.value,price:e.price*o.value};p.addToCart(s)}alert("加入购物车成功"),history.back()},f=async()=>{if(a.value){const e=await c.getById(a.value.productId),s={id:e.productId,name:e.name,imgUrl:e.imageUrl,type:"snack",num:o.value,price:e.price*o.value};await q().createOrder([s]),history.back()}},b=()=>{history.back()};return(e,s)=>r.value?(v(),d("div",R,"加载中...")):(v(),d("div",w,[t("div",{class:"back-button",onClick:b},s[2]||(s[2]=[t("div",{class:"iconfont icon-fanhui"},null,-1)])),t("div",U,[t("img",{src:`${a.value.imageUrl}`,alt:"产品图片"},null,8,x)]),t("div",D,[t("h2",null,n(a.value.name),1),t("div",{class:"favorite",onClick:m},[t("span",{class:B(["star-icon",{filled:i.value}])},"★",2),s[3]||(s[3]=t("span",null,"收藏口味",-1))])]),t("div",F,[s[4]||(s[4]=t("h3",null,"商品详情",-1)),t("div",$,n(a.value.description),1)]),t("div",N,[t("div",O,[t("span",j,"¥"+n(a.value.price*o.value),1),t("span",z,"¥"+n((a.value.price*o.value*1.2).toFixed(1)),1)]),t("div",E,[t("button",{class:"quantity-btn",onClick:s[0]||(s[0]=u=>o.value>1&&o.value--)},"-"),t("span",M,n(o.value),1),t("button",{class:"quantity-btn",onClick:s[1]||(s[1]=u=>o.value++)},"+")]),t("div",{class:"action-buttons"},[t("button",{class:"buy-now-btn",onClick:f},"立即购买"),t("button",{class:"add-cart-btn",onClick:y},"加入购物车")])])]))}},G=g(T,[["__scopeId","data-v-e11e938f"]]);export{G as default};
