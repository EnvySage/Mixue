import{_ as g,r as l,z as h,o as S,c as d,d as t,t as n,n as C,b as v}from"./index-BVNTGA3w.js";import{u as I}from"./snack-C75NDPgZ.js";import{u as B}from"./shopCar-A9r8-SBz.js";import{u as w}from"./order-GJ75ViXz.js";const q={key:0,class:"details-page"},U={class:"product-image"},x=["src"],D={class:"product-header"},F={class:"product-details"},$={class:"detail-content"},z={class:"bottom-bar"},N={class:"price-info"},O={class:"current-price"},E={class:"original-price"},M={class:"quantity-selector"},R={class:"quantity"},T={key:1},V={__name:"snackDetail",setup(j){const c=I(),p=B(),_=h(),i=l(!1),e=l(1),r=l(!0),m=_.params.id,a=l(null);S(async()=>{try{await c.getById(m),a.value=c.snack,console.log(a.value),a.value||console.error("未能获取到小吃数据")}catch(o){console.error("获取小吃详情时出错",o)}finally{r.value=!1}});const k=()=>{i.value=!i.value},y=async()=>{if(a.value){const o=await c.getById(a.value.productId),s={...o,id:o.productId,imgUrl:o.imageUrl,type:"snack",num:e.value,price:o.price*e.value};p.addToCart(s)}alert("加入购物车成功"),history.back()},f=async()=>{if(a.value){const o=await c.getById(a.value.productId),s={id:o.productId,name:o.name,imgUrl:o.imageUrl,type:"snack",num:e.value,price:o.price*e.value};await w().createOrder([s]),history.back()}},b=()=>{history.back()};return(o,s)=>r.value?(v(),d("div",T,"加载中...")):(v(),d("div",q,[t("div",{class:"back-button",onClick:b},s[2]||(s[2]=[t("div",{class:"iconfont icon-fanhui"},null,-1)])),t("div",U,[t("img",{src:`${a.value.imageUrl}`,alt:"产品图片"},null,8,x)]),t("div",D,[t("h2",null,n(a.value.name),1),t("div",{class:"favorite",onClick:k},[t("span",{class:C(["star-icon",{filled:i.value}])},"★",2),s[3]||(s[3]=t("span",null,"收藏口味",-1))])]),t("div",F,[s[4]||(s[4]=t("h3",null,"商品详情",-1)),t("div",$,n(a.value.description),1)]),t("div",z,[t("div",N,[t("span",O,"¥"+n(a.value.price*e.value),1),t("span",E,"¥"+n((a.value.price*e.value*1.2).toFixed(1)),1)]),t("div",M,[t("button",{class:"quantity-btn",onClick:s[0]||(s[0]=u=>e.value>1&&e.value--)},"-"),t("span",R,n(e.value),1),t("button",{class:"quantity-btn",onClick:s[1]||(s[1]=u=>e.value++)},"+")]),t("div",{class:"action-buttons"},[t("button",{class:"buy-now-btn",onClick:f},"立即购买"),t("button",{class:"add-cart-btn",onClick:y},"加入购物车")])])]))}},K=g(V,[["__scopeId","data-v-1c3f6c05"]]);export{K as default};
